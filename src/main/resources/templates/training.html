<!DOCTYPE html>
<html lang="en"  xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Profile</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/training.css"> 
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>

<body>
<nav class="navbar navbar-inverse">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">Personal Workout App</a>
            </div>
            <ul class="nav navbar-nav">
                <li><a href="/dashboard"><span class="glyphicon glyphicon-dashboard"></span> Dashboard</a></li>
                <li><a href="/training"><span class="glyphicon glyphicon-bullhorn"></span> Training</a></li>
                <li><a href="/nutrition"><span class="glyphicon glyphicon-leaf"></span> Nutrition</a></li>
                <li><a href="/analytics"><span class="glyphicon glyphicon-stats"></span> Analytics</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="/contact"><span class="glyphicon glyphicon-question-sign"></span> Help</a></li>
                <li><a href="/coach-profile"><span class="glyphicon glyphicon-user"></span> Profile</a></li>
                <li><a href="/login"><span class="glyphicon glyphicon-log-out"></span> Logout</a></li>
            </ul>
        </div>
    </nav>
    	
<div class="container my-2">
    <div class="card">
    <div class="card-body">
        <div th:switch="${workoutProgram}" class="container my-5">
            <p class="my-5">
                <a href="/edit-program" class="btn btn-primary">
                <i class="fas fa-user-plus ml-2"> Add Workout Program </i></a>
            </p>
            <div class="col-md-16">
                <h2 th:case="null">No record found !!</h2>
                <div th:case="*">
                    <table class="table table-striped table-responsive-md">
                        <thead>
                            <tr>
                                <th>Name Of Program</th>
                                <th>Start Date</th>
                                <th>End Date</th>
                                <th>Users</th>
                                <th>Training Days</th>
                                <th>Group</th>
                                <th>Edit</th>
                                <th>Delete</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="workoutProgram : ${workoutProgram}">
                                <td th:text="${workoutProgram.nameOfWorkoutProgram}"></td>
                                <td th:text="${workoutProgram.startDate}"></td>
                                <td th:text="${workoutProgram.endDate}"></td>
                                <td th:text="${workoutProgram.users.size}"></td>
                                <td th:text="${workoutProgram.workouts.size}"></td>
                                <td th:text="${workoutProgram.group}"></td>
                              <td>
                                    <a th:href="@{/edit-program/{id}(id=${workoutProgram.id})}"
                                             class="btn btn-primary">Edit
                                        <i class="ml-2"></i>
                                    </a>
                                </td>
                                <td>
                                    <a th:href="@{/delete-program/{id}(id=${workoutProgram.id})}"
                                              class="btn btn-danger">Delete
                                        <i class="ml-2"></i>
                                    </a>
                                </td> 
                            </tr>
                        </tbody>
                    </table>
                </div>
 
            </div>
        </div>
    	</div>
    </div>
    <div class="card">
    <div class="card-body">
        <div th:switch="${trainingDay}" class="container my-5">
            <p class="my-5">
                <a href="/edit-program" class="btn btn-primary">
                <i class="fas fa-user-plus ml-2"> Add Training Day </i></a>
            </p>
            <div class="col-md-16">
                <h2 th:case="null">No record found !!</h2>
                <div th:case="*">
                    <table class="table table-striped table-responsive-md">
                        <thead>
                            <tr>
                                <th>Name Of Exercise</th>
                                <th>Duration</th>
                                <th>Day Of Training</th>
                                <th>Sets</th>
                                <th>Repetitions</th>
                                <th>Pause</th>
                                <th>Type</th>
                                <th>Image</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="trainingDay : ${trainingDay}">
                                <td th:text="${trainingDay.nameOfExercise}"></td>
                                <td th:text="${trainingDay.duration}"></td>
                                <td th:text="${trainingDay.dayOfTraining}"></td>
                                <td th:text="${trainingDay.sets}"></td>
                                <td th:text="${trainingDay.reps}"></td>
                                <td th:text="${trainingDay.pause}"></td>
                                <td th:text="${trainingDay.type}"></td>
                                <td><img src="/personal-workout-app/myImage/ImageDisplay?id=${trainingDay.trainingDayId"/></td>
                                <td>  
                                <input type="file" id="files">


									<p id="state">No images selected</p>
									<div id="list">
									</div>
									
									<a href="#" id="deleteImgs">Delete Images</a>
							</td> 
                                
                            </tr>
                        </tbody>
                    </table>
                    
                </div>
 				
            </div>
        </div>
    	</div>
    </div>
</div>
    	
    	
    </body>
	<script type="text/javascript">
	var imagesObject = [];

	function handleFileSelect(evt) {
	    var files = evt.target.files; // FileList object

	    // Loop through the FileList and render image files as thumbnails.
	    for (var i = 0, f; f = files[i]; i++) {

	      // Only process image files.
	      if (!f.type.match('image.*')) {
	        continue;
	      }

	      var reader = new FileReader();

	      // Closure to capture the file information.
	      reader.onload = function(e) {
	          displayImgData(e.target.result)
	          addImage(e.target.result);
	      };

	      reader.readAsDataURL(f);
	    }
	}

	function loadFromLocalStorage(){
	  var images = JSON.parse(localStorage.getItem("images"))

	  if(images && images.length > 0){
	    imagesObject = images;
	    
	    displayNumberOfImgs();
	    images.forEach(displayImgData);
	  }
	}

	function addImage(imgData){
	  imagesObject.push(imgData);
	  displayNumberOfImgs();
	  localStorage.setItem("images", JSON.stringify(imagesObject));
	}

	function displayImgData(imgData){
	  var span = document.createElement('span');
	  span.innerHTML = '<img class="thumb" src="' + imgData + '"/>';
	  document.getElementById('list').insertBefore(span, null);
	}

	function displayNumberOfImgs(){
	  if(imagesObject.length > 0){

	    document.getElementById("state").innerHTML = imagesObject.length + " image" + ((imagesObject.length > 1) ? "s" : "") + " stored in your browser";
	    
	    document.getElementById("deleteImgs").style.display = "inline";
	    
	  } else {
	    document.getElementById("state").innerHTML = "No images selected";
	    document.getElementById("deleteImgs").style.display = "none";
	  }
	  
	  
	}

	function deleteImages(){
	  imagesObject = [];
	  localStorage.removeItem("images");
	  displayNumberOfImgs()
	  document.getElementById('list').innerHTML = "";
	}

	document.getElementById('files').addEventListener('change', handleFileSelect, false);
	document.getElementById('deleteImgs').addEventListener("click", deleteImages);
	loadFromLocalStorage();
	</script>
 </html>